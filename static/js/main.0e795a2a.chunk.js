(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,r){},16:function(e,t,r){"use strict";r.r(t);var i=r(0),a=r.n(i),s=r(5),n=r.n(s),o=(r(13),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,17)).then(function(t){var r=t.getCLS,i=t.getFID,a=t.getFCP,s=t.getLCP,n=t.getTTFB;r(e),i(e),a(e),s(e),n(e)})}),c=r(1),h=r.n(c),l=r(2),u=r(3);function v(e){for(var t=e.inputboard,r=e.inputwidth,i=e.inputheight,s=[],n=0;n<i;n++)s.push(n);for(var o=[],c=0;c<r+2;c++)o.push(c);var h="c";return a.a.createElement("div",{className:"TetrisBoard"},a.a.createElement("tr",{className:"TetrisRow"},o.map(function(e){return a.a.createElement("td",{className:"TetrisCell",id:"cBorder"})})),s.map(function(e){return a.a.createElement("tr",{className:"TetrisRow",id:"r"+e},a.a.createElement("td",{className:"TetrisCell",id:"cBorder"}),t[e].map(function(e){return a.a.createElement("td",{className:"TetrisCell",id:h+e})}),a.a.createElement("td",{className:"TetrisCell",id:"cBorder"}))}),a.a.createElement("tr",{className:"TetrisRow"},o.map(function(e){return a.a.createElement("td",{className:"TetrisCell",id:"cBorder"})})))}function d(e){var t=e.inputboard;return a.a.createElement("div",{className:"TetrisControls"},a.a.createElement("div",{className:"score-display"},"Score: ",t.score),a.a.createElement("div",{className:"level-display"},"Level: ",t.level),a.a.createElement("div",{className:"hold-display"},"Hold: ",t.hold),a.a.createElement("div",{className:"next-display"},"Next: ",t.next),a.a.createElement("div",{className:"highscore-display"},"Highscore: ",t.highscore),a.a.createElement("div",{className:"highlevel-display"},"Highlevel: ",t.highlevel),a.a.createElement("div",{className:"droptime"},"droptime: ",t.droptime))}var p=r(6),f=r(7),_=function(){function e(t,r){var i=this;Object(p.a)(this,e),this.width=t,this.height=r,this.board=[],this.score=0,this.level=0,this.pivot=[],this.pieces=[2,3,4,5,6,7,8],this.coor=[[0,0],[0,0],[0,0],[0,0]],this.hold=0,this.hold_swapped=!1,this.next=[0,0,0],this.highlevel=0,this.highscore=0,this.droptime=900,this.interval=setInterval(function(){i.piece_fall()},this.droptime),this.create_board()}return Object(f.a)(e,[{key:"create_board",value:function(){for(var e=[],t=0;t<this.height;t++){e[t]=[];for(var r=0;r<this.width;r++)e[t][r]=0}return this.board=e,this.next_piece_grab(),this.board}},{key:"gen_piece",value:function(e,t){0===this.pieces.length&&(this.pieces=[2,3,4,5,6,7,8]),this.pieces=this.pieces.sort(function(){return Math.random()-.5});var r=this.pieces.pop(this.pieces.length-1);if(t>1&&(r=1*t),e){for(var i={2:[[0,0],[1,-1],[1,0],[1,1],[1,0]],3:[[0,0],[0,1],[1,0],[1,1],[.5,.5]],4:[[0,-1],[0,0],[0,1],[0,2],[.5,.5]],5:[[0,1],[1,-1],[1,0],[1,1],[1,0]],6:[[0,-1],[1,-1],[1,0],[1,1],[1,0]],7:[[0,-1],[0,0],[1,0],[1,1],[1,0]],8:[[1,-1],[0,0],[1,0],[0,1],[1,0]]}[r],a=0;a<4;a++)this.board[i[a][0]+1][i[a][1]+4]=-r;this.pivot=i[4],this.pivot[0]+=1,this.pivot[1]+=4,this.update_ghost()}return r}},{key:"sleep",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}},{key:"piece_fall",value:function(){for(var e=this.update_coor(),t=!0,r=0;r<4;r++){var i=e[r][0],a=e[r][1];(i===this.height-1||this.board[i+1][a]>1)&&(t=!1)}if(!0!==t)this.solidify_piece(),this.over_stack_check();else{for(var s=this.board[e[0][0]][e[0][1]],n=0;n<4;n++)this.board[e[n][0]][e[n][1]]=0;for(var o=0;o<4;o++)this.board[e[o][0]+1][e[o][1]]=s;this.pivot[0]+=1}return t}},{key:"update_coor",value:function(){for(var e=[[],[],[],[]],t=0,r=0;r<this.height;r++)for(var i=0;i<this.width;i++)this.board[r][i]<0&&(this.coor[t][0]=r,this.coor[t][1]=i,e[t][0]=r,e[t][1]=i,t++);return e}},{key:"rotate_piece",value:function(){for(var e=this.update_coor(),t=this.pivot[0],r=this.pivot[1],i=e.slice(),a=0;a<4;a++){var s=[0,0];s[0]=t+(e[a][1]-r),s[1]=r+-(e[a][0]-t),i[a]=s}for(var n=this.board[e[0][0]][e[0][1]],o=0;o<4;o++)this.board[e[o][0]][e[o][1]]=0;var c=this.shift_coor(i,this.pivot,1,0),h=Object(u.a)(c,2),l=h[0],v=h[1],d=this.shift_coor(i,this.pivot,-1,0),p=Object(u.a)(d,2),f=p[0],_=p[1],b=this.shift_coor(i,this.pivot,0,-1),m=Object(u.a)(b,2),w=m[0],g=m[1],k=this.shift_coor(i,this.pivot,0,1),y=Object(u.a)(k,2),x=y[0],E=y[1];if(console.log(i),console.log(l),console.log(w),console.log(x),console.log(f),this.coor_is_valid(i));else this.coor_is_valid(l)?(i=l,this.pivot=v):this.coor_is_valid(w)?(i=w,this.pivot=g):this.coor_is_valid(x)?(i=x,this.pivot=E):this.coor_is_valid(f)?(i=f,this.pivot=_):i=e;for(var j=0;j<4;j++)this.board[i[j][0]][i[j][1]]=n;return this.update_ghost(),i}},{key:"shift_coor",value:function(e,t,r,i){for(var a=[],s=0;s<4;s++){var n=[];n[0]=e[s][0]+r,n[1]=e[s][1]+i,a[s]=n}return[a,[t[0]+r,t[1]+i]]}},{key:"shift_piece",value:function(e,t,r){for(var i=this.board[e[0][0]][e[0][1]],a=0;a<4;a++)this.board[e[a][0]][e[a][1]]=0;for(var s=0;s<4;s++)this.board[e[s][0]+t][e[s][1]+r]=i;this.pivot[0]+=t,this.pivot[1]+=r,this.update_ghost()}},{key:"coor_is_valid",value:function(e){for(var t=!0,r=0;r<4;r++){var i=e[r][0],a=e[r][1];if(i>this.board.length-1||i<0||a>this.board[0].length-1||a<0){t=!1;break}this.board[i][a]>1&&(t=!1)}return t}},{key:"move_left",value:function(){var e=this.update_coor(),t=this.shift_coor(e,this.pivot,0,-1)[0];return this.coor_is_valid(t)&&this.shift_piece(e,0,-1),!0}},{key:"move_right",value:function(){var e=this.update_coor(),t=this.shift_coor(e,this.pivot,0,1)[0];return this.coor_is_valid(t)&&this.shift_piece(e,0,1),!0}},{key:"move_drop",value:function(){var e=this,t=this.piece_fall();return this.score_increase(100),clearInterval(this.interval),this.interval=setInterval(function(){e.piece_fall()},this.droptime),t}},{key:"hard_drop",value:function(){for(var e=0,t=this.update_coor(),r=0;r<this.height;r++)for(var i=0;i<this.width;i++)1===this.board[r][i]&&(e=2*(r-t[0][0]-1),this.board[r][i]=this.board[t[0][0]][t[0][1]]);for(var a=0;a<4;a++)this.board[t[a][0]][t[a][1]]=1;return this.score_increase(100*e),this.solidify_piece(),this.over_stack_check(),!0}},{key:"move_hold_swap",value:function(){if(!1===this.hold_swapped){var e=this.update_coor();if(this.hold<2){this.hold=-this.board[e[0][0]][e[0][1]];for(var t=0;t<4;t++)this.board[e[t][0]][e[t][1]]=0;this.next_piece_grab()}else{for(var r=1*-this.board[e[0][0]][e[0][1]],i=0;i<4;i++)this.board[e[i][0]][e[i][1]]=0;this.gen_piece(!0,this.hold),this.hold=1*r}return this.hold_swapped=!0,this.hold}}},{key:"next_piece_grab",value:function(){if(0===this.next[0]||0===this.next[1])for(var e=0;e<3;e++)this.next[e]=this.gen_piece(!1,0);var t=1*this.next[0];return this.next=[this.next[1],this.next[2],this.gen_piece(!1,0)],this.gen_piece(!0,t),t}},{key:"solidify_piece",value:function(){for(var e=this.update_coor(),t=0;t<4;t++)this.board[e[t][0]][e[t][1]]*=-1;this.hold_swapped=!1,this.line_cleared_check(),this.next_piece_grab()}},{key:"update_ghost",value:function(){for(var e=0;e<this.height;e++)for(var t=0;t<this.width;t++)1===this.board[e][t]&&(this.board[e][t]=0);for(var r=this.update_coor(),i=0,a=0,s=!0;s;){i++;for(var n=0;n<4;n++){if(r[n][0]+i>this.board.length-1)s=!1;else this.board[r[n][0]+i][r[n][1]]>1&&(s=!1)}s&&a++}for(var o=0;o<4;o++){0===this.board[r[o][0]+a][r[o][1]]&&(this.board[r[o][0]+a][r[o][1]]=1)}return a}},{key:"line_cleared_check",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var r=!0,i=0;i<this.board[t].length;i++)this.board[t][i]<=1&&(r=!1);r&&e.push(t)}var a=e.length;this.score_increase(a);for(var s=0;s<a;s++)for(var n=0;n<this.board[e[s]].length;n++)this.board[e[s]][n]=0;for(var o=Math.max.apply(Math,e);o>=0;o--)for(var c=0;c<this.board[o].length;c++)if(this.board[o][c]>1){for(var h=0,l=0;l<a;l++)e[l]>o&&h++;var u=this.board[o][c];this.board[o][c]=0,this.board[o+h][c]=u}return e}},{key:"over_stack_check",value:function(){for(var e=!0,t=0;t<this.board[3].length;t++)this.board[3][t]>0&&(e=!1);if(!0!==e){var r=this.reset_all();this.highscore=Math.max(r[1],this.highscore),this.highlevel=Math.max(r[0],this.highlevel)}}},{key:"time_drop_calc",value:function(){this.droptime=700*Math.pow(.86,.5*this.level)+200}},{key:"level_update",value:function(){this.level=Math.max(this.level,Math.floor((-65+Math.sqrt(13*(325+2*this.score)))/130)),this.time_drop_calc()}},{key:"reset_all",value:function(){var e=this.score,t=this.level;return this.board=[],this.score=0,this.level=0,this.droptime=900,this.pieces=[2,3,4,5,6,7,8],this.pivot=[],this.coor=[[0,0],[0,0],[0,0],[0,0]],this.hold=0,this.hold_swapped=!1,this.next=[0,0,0],this.create_board(),[t,e]}},{key:"score_increase",value:function(e){if(e>4){var t=e/100;this.score=this.score+t*(this.level+1)}else 1===e&&(this.score=this.score+40*(this.level+1)),2===e&&(this.score=this.score+100*(this.level+1)),3===e&&(this.score=this.score+300*(this.level+1)),4===e&&(this.score=this.score+1200*(this.level+1)),this.level_update();return this.score}},{key:"stop_drop",value:function(){clearInterval(this.interval)}},{key:"start_drop",value:function(){var e=this;clearInterval(this.interval),this.interval=setInterval(function(){e.piece_fall()},this.droptime)}}]),e}(),b=function(e){var t=Object(i.useState)(),r=Object(u.a)(t,2),a=r[0],s=r[1];return Object(i.useEffect)(function(){var t=function(t){var r=t.key;1===r.length&&(s(r),e&&e(r))},r=function(){s(null)};return window.addEventListener("keydown",t),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",r)}}),a},m=10,w=24,g=(new Date,new _(m,w));g.start_drop();var k=function(){var e=Object(i.useState)(g.board),t=Object(u.a)(e,2),r=t[0],s=t[1],n=Object(i.useState)(Date.now()),o=Object(u.a)(n,2),c=(o[0],o[1]);return Object(i.useEffect)(function(){var e=setInterval(function(){return c(Date.now())},50);return function(){(function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(g.board);case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()(),clearInterval(e)}},[]),b(function(e){switch(console.log(g.interval),console.log(e),e){case"a":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.move_left();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"d":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.move_right();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"s":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.move_drop();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"w":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.rotate_piece();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"h":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.move_hold_swap();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"-":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.stop_drop();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case"=":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.start_drop();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();break;case" ":!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.hard_drop();case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()}!function(){var e=Object(l.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(g.board);case 2:e.sent;case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()}),a.a.createElement("div",{className:"TetrisGame"},a.a.createElement(d,{inputboard:g}),a.a.createElement(v,{inputboard:r,inputheight:w,inputwidth:m}))};n.a.render(a.a.createElement(k,null),document.getElementById("root")),o()},8:function(e,t,r){e.exports=r(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.0e795a2a.chunk.js.map